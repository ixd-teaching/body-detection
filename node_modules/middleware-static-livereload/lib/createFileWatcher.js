"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createFileWatcher = void 0;
const chokidar = require("chokidar");
const isFSWatcher = (x) => typeof x === 'object'
    && 'add' in x
    && typeof x.add === 'function'
    && 'unwatch' in x
    && typeof x.unwatch === 'function';
const createFileWatcher = ({ watch }) => {
    if (watch === false || watch === null) {
        return null;
    }
    if (isFSWatcher(watch)) {
        return watch;
    }
    return chokidar.watch([], {
        useFsEvents: false,
        ignoreInitial: false,
        awaitWriteFinish: {
            stabilityThreshold: 300,
        },
        ...(typeof watch === 'object' ? watch : null),
    });
};
exports.createFileWatcher = createFileWatcher;
