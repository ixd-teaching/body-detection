"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createInserter = exports.defaultInsertAfter = exports.defaultInsertBefore = void 0;
const ensureArray_1 = require("./ensureArray");
exports.defaultInsertBefore = [
    /<\/head/i,
    /<\/body/i,
    /<meta/i,
    /<title/i,
    /<script/i,
    /<link/i,
];
exports.defaultInsertAfter = [
    /<!doctype\s*html\s*>/i,
];
const createInserter = (options = {}) => {
    const [insertBefore, insertAfter] = (options.insertBefore || options.insertAfter) ? [
        ensureArray_1.ensureArray(options.insertBefore || []),
        ensureArray_1.ensureArray(options.insertAfter || []),
    ] : [exports.defaultInsertBefore, exports.defaultInsertAfter];
    return (input, insertee) => {
        for (const pattern of insertBefore) {
            const result = input.replace(pattern, `${insertee}$&`);
            if (result !== input) {
                return result;
            }
        }
        for (const pattern of insertAfter) {
            const result = input.replace(pattern, `$&${insertee}`);
            if (result !== input) {
                return result;
            }
        }
        return null;
    };
};
exports.createInserter = createInserter;
