"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.listen = exports.listenPort = void 0;
const hostname = 'localhost';
const listenPort = async (server, port) => {
    await new Promise((resolve, reject) => {
        server
            .once('error', (error) => {
            if (error.code === 'EADDRINUSE' || error.code === 'EADDRNOTAVAIL') {
                resolve();
            }
            else {
                reject(error);
            }
        })
            .once('listening', () => {
            server.removeListener('error', reject);
            resolve();
        })
            .listen(port, hostname);
    });
};
exports.listenPort = listenPort;
const listen = async (server, port) => {
    await exports.listenPort(server, port);
    if (server.listening) {
        return port;
    }
    else {
        return await exports.listen(server, port + 1);
    }
};
exports.listen = listen;
